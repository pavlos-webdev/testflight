<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight Finder App</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Optional: Invert map tiles in dark mode to make them look "dark" */
        .dark-mode-tiles .leaflet-tile {
            filter: invert(100%) hue-rotate(180deg) brightness(95%) contrast(90%);
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ============================================
        // AMADEUS API CONFIGURATION
        // ============================================
        // PASTE YOUR KEYS HERE
        const AMADEUS_API_KEY = ' ';
        const AMADEUS_API_SECRET = '';
        const AMADEUS_API_URL = 'https://test.api.amadeus.com';

        const FlightSearchApp = () => {
          const [departure, setDeparture] = useState('');
          const [departureDate, setDepartureDate] = useState('');
          const [returnDate, setReturnDate] = useState('');
          const [destination, setDestination] = useState(null);
          const [destinationCity, setDestinationCity] = useState('');
          const [flights, setFlights] = useState([]);
          const [loading, setLoading] = useState(false);
          const [error, setError] = useState('');
          const [darkMode, setDarkMode] = useState(false);
          const mapRef = useRef(null);
          const mapInstanceRef = useRef(null);
          const markerRef = useRef(null);

          const airports = [
            // United States
            { code: 'JFK', name: 'New York JFK', lat: 40.6413, lon: -73.7781 },
            { code: 'LAX', name: 'Los Angeles', lat: 33.9416, lon: -118.4085 },
            { code: 'ORD', name: 'Chicago O\'Hare', lat: 41.9742, lon: -87.9073 },
            { code: 'MIA', name: 'Miami', lat: 25.7959, lon: -80.2870 },
            { code: 'DFW', name: 'Dallas/Fort Worth', lat: 32.8998, lon: -97.0403 },
            { code: 'SFO', name: 'San Francisco', lat: 37.6213, lon: -122.3790 },
            { code: 'SEA', name: 'Seattle-Tacoma', lat: 47.4502, lon: -122.3088 },
            { code: 'LAS', name: 'Las Vegas', lat: 36.0840, lon: -115.1537 },
            { code: 'ATL', name: 'Atlanta', lat: 33.6407, lon: -84.4277 },
            { code: 'BOS', name: 'Boston Logan', lat: 42.3656, lon: -71.0096 },
            { code: 'MCO', name: 'Orlando', lat: 28.4312, lon: -81.3081 },
            { code: 'DEN', name: 'Denver', lat: 39.8561, lon: -104.6737 },
            
            // Europe
            { code: 'LHR', name: 'London Heathrow', lat: 51.4700, lon: -0.4543 },
            { code: 'CDG', name: 'Paris Charles de Gaulle', lat: 49.0097, lon: 2.5479 },
            { code: 'FRA', name: 'Frankfurt', lat: 50.0379, lon: 8.5622 },
            { code: 'AMS', name: 'Amsterdam Schiphol', lat: 52.3105, lon: 4.7683 },
            { code: 'MAD', name: 'Madrid Barajas', lat: 40.4936, lon: -3.5668 },
            { code: 'FCO', name: 'Rome Fiumicino', lat: 41.8003, lon: 12.2389 },
            { code: 'IST', name: 'Istanbul', lat: 41.2753, lon: 28.7519 },
            { code: 'MUC', name: 'Munich', lat: 48.3537, lon: 11.7750 },
            { code: 'BCN', name: 'Barcelona', lat: 41.2974, lon: 2.0833 },
            { code: 'LGW', name: 'London Gatwick', lat: 51.1537, lon: -0.1821 },
            { code: 'ZRH', name: 'Zurich', lat: 47.4647, lon: 8.5492 },
            { code: 'VIE', name: 'Vienna', lat: 48.1103, lon: 16.5697 },
            
            // Middle East
            { code: 'DXB', name: 'Dubai', lat: 25.2532, lon: 55.3657 },
            { code: 'DOH', name: 'Doha Hamad', lat: 25.2731, lon: 51.6080 },
            { code: 'AUH', name: 'Abu Dhabi', lat: 24.4330, lon: 54.6511 },
            
            // Asia
            { code: 'NRT', name: 'Tokyo Narita', lat: 35.7720, lon: 140.3929 },
            { code: 'HND', name: 'Tokyo Haneda', lat: 35.5494, lon: 139.7798 },
            { code: 'HKG', name: 'Hong Kong', lat: 22.3080, lon: 113.9185 },
            { code: 'SIN', name: 'Singapore Changi', lat: 1.3644, lon: 103.9915 },
            { code: 'ICN', name: 'Seoul Incheon', lat: 37.4602, lon: 126.4407 },
            { code: 'PVG', name: 'Shanghai Pudong', lat: 31.1443, lon: 121.8083 },
            { code: 'BKK', name: 'Bangkok Suvarnabhumi', lat: 13.6900, lon: 100.7501 },
            { code: 'KUL', name: 'Kuala Lumpur', lat: 2.7456, lon: 101.7099 },
            { code: 'DEL', name: 'Delhi', lat: 28.5562, lon: 77.1000 },
            { code: 'BOM', name: 'Mumbai', lat: 19.0896, lon: 72.8656 },
            
            // Oceania
            { code: 'SYD', name: 'Sydney', lat: -33.9399, lon: 151.1753 },
            { code: 'MEL', name: 'Melbourne', lat: -37.6690, lon: 144.8410 },
            { code: 'AKL', name: 'Auckland', lat: -37.0082, lon: 174.7850 },
            
            // South America
            { code: 'GRU', name: 'São Paulo', lat: -23.4356, lon: -46.4731 },
            { code: 'GIG', name: 'Rio de Janeiro', lat: -22.8099, lon: -43.2505 },
            { code: 'EZE', name: 'Buenos Aires', lat: -34.8222, lon: -58.5358 },
            { code: 'BOG', name: 'Bogotá', lat: 4.7016, lon: -74.1469 },
            
            // Canada
            { code: 'YYZ', name: 'Toronto Pearson', lat: 43.6777, lon: -79.6248 },
            { code: 'YVR', name: 'Vancouver', lat: 49.1939, lon: -123.1844 },
            { code: 'YUL', name: 'Montreal', lat: 45.4706, lon: -73.7408 },
            
            // Africa
            { code: 'JNB', name: 'Johannesburg', lat: -26.1392, lon: 28.2460 },
            { code: 'CAI', name: 'Cairo', lat: 30.1219, lon: 31.4056 },
            { code: 'CPT', name: 'Cape Town', lat: -33.9715, lon: 18.6021 }
          ];

          useEffect(() => {
            if (window.L && mapRef.current && !mapInstanceRef.current) {
              setTimeout(() => initMap(), 100);
            }
          }, []);

          // ============================================
          // FIX: MAP RENDER REFRESH ON DARK MODE TOGGLE
          // ============================================
          useEffect(() => {
            if (mapInstanceRef.current) {
                // We add a small delay to allow the CSS transition (colors/borders) to finish
                // before recalculating the map size. This prevents the "grey map" glitch.
                setTimeout(() => {
                    mapInstanceRef.current.invalidateSize();
                    
                    // Optional: Update tile layer class for dark mode visual effect
                    const container = mapInstanceRef.current.getContainer();
                    if (darkMode) {
                        container.classList.add('dark-mode-tiles');
                    } else {
                        container.classList.remove('dark-mode-tiles');
                    }
                }, 300);
            }
          }, [darkMode]);

          useEffect(() => {
            if (departure && departureDate && returnDate && destination) {
              searchFlights(departure);
            }
          }, [departure, departureDate, returnDate, destination]);

          const initMap = () => {
            if (mapInstanceRef.current) return;

            const L = window.L;
            
            const maxBounds = L.latLngBounds(
              L.latLng(-85, -180),
              L.latLng(85, 180)
            );
            
            const map = L.map(mapRef.current, {
              maxBounds: maxBounds,
              maxBoundsViscosity: 1.0,
              minZoom: 2,
              maxZoom: 19,
              zoomControl: true,
              worldCopyJump: true
            }).setView([20, 0], 2);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: '© OpenStreetMap contributors',
              maxZoom: 19,
              minZoom: 2,
              bounds: maxBounds,
              noWrap: true
            }).addTo(map);

            setTimeout(() => {
              map.invalidateSize();
            }, 200);

            map.on('click', handleMapClick);
            mapInstanceRef.current = map;
          };

          const handleMapClick = async (e) => {
            console.log('Map clicked at:', e.latlng);
            const { lat, lng } = e.latlng;
            setDestination({ lat, lng });
            setError('');
            
            const L = window.L;
            if (markerRef.current) {
              mapInstanceRef.current.removeLayer(markerRef.current);
            }
            
            markerRef.current = L.marker([lat, lng]).addTo(mapInstanceRef.current);
            
            console.log('Calling reverseGeocode...');
            await reverseGeocode(lat, lng);
          };

          const reverseGeocode = async (lat, lng) => {
            console.log('Reverse geocoding:', lat, lng);
            try {
              const response = await fetch(
                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=10`
              );
              const data = await response.json();
              console.log('Geocode response:', data);
              
              const city = data.address?.city || 
                           data.address?.town || 
                           data.address?.village || 
                           data.address?.county || 
                           data.address?.state || 
                           'Unknown Location';
              
              console.log('City found:', city);
              setDestinationCity(city);
            } catch (err) {
              console.error('Geocoding error:', err);
              setError('Failed to determine location name');
            }
          };

          const findNearestAirport = (lat, lng) => {
            let nearest = null;
            let minDistance = Infinity;
            
            airports.forEach(airport => {
              const distance = Math.sqrt(
                Math.pow(airport.lat - lat, 2) + 
                Math.pow(airport.lon - lng, 2)
              );
              
              if (distance < minDistance) {
                minDistance = distance;
                nearest = airport;
              }
            });
            
            return nearest;
          };

          const getAmadeusToken = async () => {
            try {
              const response = await fetch(`${AMADEUS_API_URL}/v1/security/oauth2/token`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: `grant_type=client_credentials&client_id=${AMADEUS_API_KEY}&client_secret=${AMADEUS_API_SECRET}`
              });
              
              if (!response.ok) {
                throw new Error('Authentication failed');
              }
              
              const data = await response.json();
              return data.access_token;
            } catch (err) {
              console.error('Error getting Amadeus token:', err);
              throw new Error('Failed to authenticate with Amadeus API');
            }
          };

          const bookFlight = (flight) => {
             const query = `Flights from ${flight.departure} to ${flight.arrival} on ${flight.departureDate} ${returnDate ? `returning ${returnDate}` : ''}`;
             const url = `https://www.google.com/travel/flights?q=${encodeURIComponent(query)}`;
             window.open(url, '_blank');
          };

          const searchFlights = async (from) => {
            console.log('searchFlights called with:', from);
            
            if (!from || !destination || !departureDate || !returnDate) {
              console.log('Missing required fields');
              return;
            }
            
            setLoading(true);
            setError('');
            
            try {
              if (AMADEUS_API_KEY === 'YOUR_API_KEY_HERE' || AMADEUS_API_SECRET === 'YOUR_API_SECRET_HERE') {
                setError('Please add your Amadeus API credentials at the top of the file (lines 22-23)');
                setFlights([]);
                setLoading(false);
                return;
              }
              
              const token = await getAmadeusToken();
              const destinationAirport = findNearestAirport(destination.lat, destination.lng);
              
              if (!destinationAirport) {
                setError('No airport found near this location. Please select a different destination.');
                setFlights([]);
                setLoading(false);
                return;
              }
              
              const url = `${AMADEUS_API_URL}/v2/shopping/flight-offers?originLocationCode=${from}&destinationLocationCode=${destinationAirport.code}&departureDate=${departureDate}&returnDate=${returnDate}&adults=1&currencyCode=USD&max=50`;
              
              const flightResponse = await fetch(url, {
                headers: {
                  'Authorization': `Bearer ${token}`
                }
              });
              
              if (!flightResponse.ok) {
                const errorData = await flightResponse.json();
                throw new Error(errorData.errors?.[0]?.detail || 'Failed to fetch flights');
              }
              
              const flightData = await flightResponse.json();
              
              if (!flightData.data || flightData.data.length === 0) {
                setError('No flights found for this route and dates. Try a different destination or dates.');
                setFlights([]);
                setLoading(false);
                return;
              }
              
              const dictionaries = flightData.dictionaries || {};
              const carriers = dictionaries.carriers || {};
              
              const mappedFlights = flightData.data.map((offer) => {
                const outboundSegments = offer.itineraries[0].segments;
                const returnSegments = offer.itineraries[1]?.segments || [];
                
                const outboundFirst = outboundSegments[0];
                const outboundLast = outboundSegments[outboundSegments.length - 1];
                const returnFirst = returnSegments[0];
                const returnLast = returnSegments[returnSegments.length - 1];
                
                const outboundDepTime = new Date(outboundFirst.departure.at);
                const outboundArrTime = new Date(outboundLast.arrival.at);
                const returnDepTime = returnFirst ? new Date(returnFirst.departure.at) : null;
                const returnArrTime = returnLast ? new Date(returnLast.arrival.at) : null;
                
                const airlineName = carriers[outboundFirst.carrierCode] || outboundFirst.carrierCode;
                
                return {
                  id: offer.id,
                  airline: airlineName,
                  airlineCode: outboundFirst.carrierCode,
                  flightNumber: `${outboundFirst.carrierCode}${outboundFirst.number}`,
                  departure: outboundFirst.departure.iataCode,
                  arrival: outboundLast.arrival.iataCode,
                  outboundDepartureTime: outboundDepTime.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: false 
                  }),
                  outboundArrivalTime: outboundArrTime.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: false 
                  }),
                  returnDepartureTime: returnDepTime ? returnDepTime.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: false 
                  }) : null,
                  returnArrivalTime: returnArrTime ? returnArrTime.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: false 
                  }) : null,
                  departureDate: outboundDepTime.toISOString().split('T')[0],
                  outboundDuration: offer.itineraries[0].duration.replace('PT', '').replace('H', 'h ').replace('M', 'm').toLowerCase(),
                  returnDuration: offer.itineraries[1] ? offer.itineraries[1].duration.replace('PT', '').replace('H', 'h ').replace('M', 'm').toLowerCase() : null,
                  price: parseFloat(offer.price.total),
                  currency: 'USD',
                  outboundStops: outboundSegments.length - 1,
                  returnStops: returnSegments.length - 1
                };
              });

              // Deduplicate flights
              const uniqueFlights = [];
              const seenFlights = new Set();

              mappedFlights.forEach(flight => {
                const uniqueKey = `${flight.flightNumber}-${flight.departureDate}-${flight.outboundDepartureTime}`;
                if (!seenFlights.has(uniqueKey)) {
                    seenFlights.add(uniqueKey);
                    uniqueFlights.push(flight);
                }
              });

              setFlights(uniqueFlights.slice(0, 10));
              
            } catch (err) {
              console.error('Flight search error:', err);
              setError(err.message || 'Failed to fetch flights. Please check your API credentials and try again.');
              setFlights([]);
            } finally {
              setLoading(false);
            }
          };

          const handleDepartureChange = (e) => {
            const code = e.target.value;
            console.log('Departure changed to:', code);
            setDeparture(code);
          };

          return (
            <div className={`min-h-screen transition-colors duration-300 ${darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-blue-50 to-indigo-100'} p-4`}>
              <div className="max-w-7xl mx-auto">
                <div className={`rounded-2xl shadow-xl overflow-hidden ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                  <div className={`p-6 text-white relative ${darkMode ? 'bg-gradient-to-r from-gray-700 to-gray-900' : 'bg-gradient-to-r from-blue-600 to-indigo-600'}`}>
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-3">
                        <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                        </svg>
                        <div>
                          <h1 className="text-3xl font-bold">Flight Finder</h1>
                          <p className={`mt-2 ${darkMode ? 'text-gray-300' : 'text-blue-100'}`}>Select your departure airport and click on the map to find flights</p>
                        </div>
                      </div>
                      
                    </div>
                  </div>

                  <div className="p-6">
                    <div className="mb-6">
                      <label className={`block text-sm font-semibold mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                        Departure Airport
                      </label>
                      <select
                        value={departure}
                        onChange={handleDepartureChange}
                        className={`w-full p-3 border-2 rounded-lg focus:outline-none transition-colors ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-blue-400' : 'bg-white border-gray-300 text-gray-900 focus:border-blue-500'}`}
                      >
                        <option value="">Select departure airport...</option>
                        {airports.map(airport => (
                          <option key={airport.code} value={airport.code}>
                            {airport.code} - {airport.name}
                          </option>
                        ))}
                      </select>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                      <div>
                        <label className={`block text-sm font-semibold mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                          Departure Date
                        </label>
                        <input
                          type="date"
                          value={departureDate}
                          onChange={(e) => setDepartureDate(e.target.value)}
                          min={new Date().toISOString().split('T')[0]}
                          className={`w-full p-3 border-2 rounded-lg focus:outline-none transition-colors ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-blue-400' : 'bg-white border-gray-300 text-gray-900 focus:border-blue-500'}`}
                        />
                      </div>

                      <div>
                        <label className={`block text-sm font-semibold mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                          Return Date
                        </label>
                        <input
                          type="date"
                          value={returnDate}
                          onChange={(e) => setReturnDate(e.target.value)}
                          min={departureDate || new Date().toISOString().split('T')[0]}
                          className={`w-full p-3 border-2 rounded-lg focus:outline-none transition-colors ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-blue-400' : 'bg-white border-gray-300 text-gray-900 focus:border-blue-500'}`}
                        />
                      </div>
                    </div>

                    <div className="mb-6">
                      <div className="flex items-center justify-between mb-2">
                        <label className={`block text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                          Select Destination on Map
                        </label>
                        {destinationCity && (
                          <div className={`flex items-center gap-2 text-sm font-medium ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>
                            <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                              <path fillRule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clipRule="evenodd" />
                            </svg>
                            {destinationCity}
                          </div>
                        )}
                      </div>
                      <div 
                        ref={mapRef} 
                        className={`w-full rounded-lg border-2 shadow-inner ${darkMode ? 'border-gray-600' : 'border-gray-300'}`}
                        style={{ height: '500px' }}
                      />
                    </div>

                    {error && (
                      <div className={`mb-4 p-4 border-l-4 rounded ${darkMode ? 'bg-red-900 border-red-600 text-red-200' : 'bg-red-50 border-red-500 text-red-700'}`}>
                        {error}
                      </div>
                    )}

                    {loading && (
                      <div className="flex items-center justify-center py-12">
                        <svg className={`w-8 h-8 animate-spin ${darkMode ? 'text-blue-400' : 'text-blue-600'}`} fill="none" viewBox="0 0 24 24">
                          <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                          <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span className={`ml-3 ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>Searching for flights...</span>
                      </div>
                    )}

                    {!loading && flights.length > 0 && (
                      <div>
                        <h2 className={`text-xl font-bold mb-4 ${darkMode ? 'text-gray-100' : 'text-gray-800'}`}>
                          Available Flights ({flights.length})
                        </h2>
                        <div className="space-y-4">
                          {flights.map(flight => (
                            <div 
                              key={flight.id}
                              className={`border-2 rounded-lg p-4 transition-all ${darkMode ? 'border-gray-600 hover:border-blue-400 bg-gray-700' : 'border-gray-200 hover:border-blue-400 bg-white'} hover:shadow-md`}
                            >
                              <div className="flex justify-between items-start mb-3">
                                <div>
                                  <div className={`font-bold text-lg ${darkMode ? 'text-gray-100' : 'text-gray-800'}`}>
                                    {flight.airline}
                                  </div>
                                  <div className={`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
                                    Flight {flight.flightNumber}
                                  </div>
                                </div>
                                <div className="text-right">
                                  <div className={`text-2xl font-bold ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>
                                    ${flight.price}
                                  </div>
                                  <div className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-500'} mb-2`}>per person</div>
                                  
                                  <button
                                    onClick={() => bookFlight(flight)}
                                    className={`px-3 py-1.5 rounded text-sm font-semibold transition-colors flex items-center justify-center gap-1 ${
                                      darkMode 
                                        ? 'bg-blue-600 hover:bg-blue-500 text-white' 
                                        : 'bg-blue-600 hover:bg-blue-700 text-white'
                                    }`}
                                  >
                                    View on Google Flights
                                    <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                    </svg>
                                  </button>

                                </div>
                              </div>
                              
                              <div className={`mb-4 pb-4 border-b ${darkMode ? 'border-gray-600' : 'border-gray-200'}`}>
                                <div className={`text-xs font-semibold mb-2 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>OUTBOUND</div>
                                <div className="flex items-center justify-between">
                                  <div className="text-center">
                                    <div className={`text-xl font-semibold ${darkMode ? 'text-gray-100' : 'text-gray-800'}`}>
                                      {flight.outboundDepartureTime}
                                    </div>
                                    <div className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>{flight.departure}</div>
                                  </div>
                                  
                                  <div className="flex-1 mx-4">
                                    <div className={`text-center text-xs mb-1 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
                                      {flight.outboundDuration}
                                    </div>
                                    <div className="relative">
                                      <div className={`h-0.5 ${darkMode ? 'bg-gray-600' : 'bg-gray-300'}`}></div>
                                      <svg className={`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-5 h-5 rotate-90 ${darkMode ? 'text-blue-400' : 'text-blue-600'}`} fill="currentColor" viewBox="0 0 20 20">
                                        <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" />
                                      </svg>
                                    </div>
                                    <div className={`text-center text-xs mt-1 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
                                      {flight.outboundStops === 0 ? 'Non-stop' : `${flight.outboundStops} stop${flight.outboundStops > 1 ? 's' : ''}`}
                                    </div>
                                  </div>
                                  
                                  <div className="text-center">
                                    <div className={`text-xl font-semibold ${darkMode ? 'text-gray-100' : 'text-gray-800'}`}>
                                      {flight.outboundArrivalTime}
                                    </div>
                                    <div className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>{flight.arrival}</div>
                                  </div>
                                </div>
                              </div>

                              {flight.returnDepartureTime && (
                                <div className="mb-3">
                                  <div className={`text-xs font-semibold mb-2 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>RETURN</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-center">
                                      <div className={`text-xl font-semibold ${darkMode ? 'text-gray-100' : 'text-gray-800'}`}>
                                        {flight.returnDepartureTime}
                                      </div>
                                      <div className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>{flight.arrival}</div>
                                    </div>
                                    
                                    <div className="flex-1 mx-4">
                                      <div className={`text-center text-xs mb-1 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
                                        {flight.returnDuration}
                                      </div>
                                      <div className="relative">
                                        <div className={`h-0.5 ${darkMode ? 'bg-gray-600' : 'bg-gray-300'}`}></div>
                                        <svg className={`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-5 h-5 -rotate-90 ${darkMode ? 'text-blue-400' : 'text-blue-600'}`} fill="currentColor" viewBox="0 0 20 20">
                                          <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z" />
                                        </svg>
                                      </div>
                                      <div className={`text-center text-xs mt-1 ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>
                                        {flight.returnStops === 0 ? 'Non-stop' : `${flight.returnStops} stop${flight.returnStops > 1 ? 's' : ''}`}
                                      </div>
                                    </div>
                                    
                                    <div className="text-center">
                                      <div className={`text-xl font-semibold ${darkMode ? 'text-gray-100' : 'text-gray-800'}`}>
                                        {flight.returnArrivalTime}
                                      </div>
                                      <div className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>{flight.departure}</div>
                                    </div>
                                  </div>
                                </div>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<FlightSearchApp />);
    </script>
</body>
</html>